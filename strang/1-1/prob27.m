% --- 1. 前進差分行列 A0 (3x4) を定義 ---
% 問題27の画像にある通りの行列
A0 = [-1  1  0  0;
       0 -1  1  0;
       0  0 -1  1];

disp('=== A0 (元の行列) ===')
disp(A0)

% --- 2. 検証：どっちの列を消すと T になるか？ ---

% パターンA：第1列を削除してみる
disp('--- パターンA：第1列を削除した場合 (T_reversed) ---')
A_remove_col1 = A0(:, 2:4)
T_reversed = A_remove_col1' * A_remove_col1
disp('  これは「右端が自由」な状態。問題1の T とは逆。')

% パターンB：最後の列(第4列)を削除してみる
disp(' ')
disp('--- パターンB：最後の列を削除した場合 (T_standard) ---')
A_1 = A0(:, 1:3)
T_standard = A_1' * A_1
disp('→ 対角成分が [1 2 2] になる。')
disp('  これこそが問題1に出てくる T (T_11 = 1)')


% --- 3. K を作る（両端を固定） ---
disp(' ')
disp('=== K (両端固定) ===')
disp('第1列と第4列の両方を削除:')
A_2 = A0(:, 2:3) % 2列目と3列目だけ残す
K = A_2' * A_2
